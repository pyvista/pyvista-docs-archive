
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PyVista within a Docker Container &#8212; PyVista 0.31.dev0 documentation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Freezing PyVista with pyinstaller" href="pyinstaller.html" />
    <link rel="prev" title="Building VTK" href="building_vtk.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/pyvista_logo_sm.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../getting-started/index.html">
  Getting Started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../user-guide/index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../examples/index.html">
  Examples
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../api.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  Extras
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/pyvista/pyvista" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="http://slack.pyvista.org" rel="noopener" target="_blank" title="Slack Community">
            <span><i class="fab fa-slack"></i></span>
            <label class="sr-only">Slack Community</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/pyvista/pyvista-support" rel="noopener" target="_blank" title="Support">
            <span><i class="fa fa-comment fa-fw"></i></span>
            <label class="sr-only">Support</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/pyvista/pyvista/blob/master/CONTRIBUTING.md" rel="noopener" target="_blank" title="Contributing">
            <span><i class="fa fa-gavel fa-fw"></i></span>
            <label class="sr-only">Contributing</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://doi.org/10.21105/joss.01450" rel="noopener" target="_blank" title="The Paper">
            <span><i class="fa fa-file-text fa-fw"></i></span>
            <label class="sr-only">The Paper</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="building_vtk.html">
   Building VTK
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   PyVista within a Docker Container
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pyinstaller.html">
   Freezing PyVista with pyinstaller
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="flask.html">
   Flask Application
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="developer_notes.html">
   Contributing
  </a>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-your-own-docker-container-with-pyvista">
   Create your own Docker Container with
   <cite>
    pyvista
   </cite>
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="pyvista-within-a-docker-container">
<h1>PyVista within a Docker Container<a class="headerlink" href="#pyvista-within-a-docker-container" title="Permalink to this headline">¶</a></h1>
<p>You can use <code class="docutils literal notranslate"><span class="pre">pyvista</span></code> from within a docker container with
jupyterlab.  To create a local docker image install <code class="docutils literal notranslate"><span class="pre">docker</span></code> and be
sure you’ve logged into docker by following the directions at
<a class="reference external" href="https://docs.github.com/en/free-pro-team&#64;latest/packages/using-github-packages-with-your-projects-ecosystem/configuring-docker-for-use-with-github-packages#authenticating-with-a-personal-access-token">Configuring Docker for use with GitHub Packages</a>)</p>
<p>Next pull and run the image with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker run -p <span class="m">8888</span>:8888 docker.pkg.github.com/pyvista/pyvista/pyvista-jupyterlab:v0.27.0
</pre></div>
</div>
<p>Finally, open the link that shows up from the terminal output and
start playing around with pyvista in jupyterlab!  For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>To access the notebook, open this file in a browser:
    file:///home/jovyan/.local/share/jupyter/runtime/nbserver-6-open.html
Or copy and paste one of these URLs:
    http://861c873f6352:8888/?token=b3ac1f6397188944fb21e1f58b673b5b4e6f1ede1a84787b
 or http://127.0.0.1:8888/?token=b3ac1f6397188944fb21e1f58b673b5b4e6f1ede1a84787b
</pre></div>
</div>
<div class="section" id="create-your-own-docker-container-with-pyvista">
<h2>Create your own Docker Container with <cite>pyvista</cite><a class="headerlink" href="#create-your-own-docker-container-with-pyvista" title="Permalink to this headline">¶</a></h2>
<p>Clone pyvista and cd into this directory to create your own customized docker image.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/pyvista/pyvista
<span class="nb">cd</span> pyvista/docker
<span class="nv">IMAGE</span><span class="o">=</span>my-pyvista-jupyterlab:v0.1.0
docker build -t <span class="nv">$IMAGE</span> .
docker push <span class="nv">$IMAGE</span>
</pre></div>
</div>
<p>If you wish to have off-screen GPU support when rending on jupyterlab,
see the the notes about building with EGL at <a class="reference internal" href="building_vtk.html#ref-building-vtk"><span class="std std-ref">Building VTK</span></a>,
or use the custom, pre-built wheels at
<a class="reference external" href="https://github.com/pyvista/pyvista/releases/tag/0.27.0">Release 0.27.0</a>.
Install that customized vtk wheel onto your docker image by modifying
the docker image at <code class="docutils literal notranslate"><span class="pre">pyvista/docker/Dockerfile</span></code> with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">COPY</span> <span class="n">vtk</span><span class="o">-</span><span class="mf">9.0.20201105</span><span class="o">-</span><span class="n">cp38</span><span class="o">-</span><span class="n">cp38</span><span class="o">-</span><span class="n">linux_x86_64</span><span class="o">.</span><span class="n">whl</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span>
<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">vtk</span><span class="o">-</span><span class="mf">9.0.20201105</span><span class="o">-</span><span class="n">cp38</span><span class="o">-</span><span class="n">cp38</span><span class="o">-</span><span class="n">linux_x86_64</span><span class="o">.</span><span class="n">whl</span>
</pre></div>
</div>
<p>Additionally, you must install GPU drivers on the docker image of the
same version running on the host machine.  For example, if you are
running on Azure Kubernetes Service and the GPU nodes on the
kubernetes cluster are running <code class="docutils literal notranslate"><span class="pre">450.51.06</span></code>, you must install the same
version on your image.  Since you will be using the underlying kernel
module, there’s no reason to build it on the container (and trying
will only result in an error).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">COPY</span> <span class="n">NVIDIA</span><span class="o">-</span><span class="n">Linux</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="mf">450.51.06</span><span class="o">.</span><span class="n">run</span> <span class="n">nvidia_drivers</span><span class="o">.</span><span class="n">run</span>
<span class="n">RUN</span> <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">kmod</span> <span class="n">libglvnd</span><span class="o">-</span><span class="n">dev</span> <span class="n">pkg</span><span class="o">-</span><span class="n">config</span> <span class="o">-</span><span class="n">yq</span>
<span class="n">RUN</span> <span class="o">./</span><span class="n">NVIDIA</span><span class="o">-</span><span class="n">Linux</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="mf">450.51.06</span><span class="o">.</span><span class="n">run</span> <span class="o">-</span><span class="n">s</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">kernel</span><span class="o">-</span><span class="n">module</span>
</pre></div>
</div>
<p>To verify that you’re rendering on a GPU, first check the output of
<code class="docutils literal notranslate"><span class="pre">nvidia-smi</span></code>.  You should get something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ nvidia-smi
Sun Nov  8 05:48:46 2020
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 450.51.06    Driver Version: 450.51.06    CUDA Version: 11.0     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla K80           Off  | 00000001:00:00.0 Off |                    0 |
| N/A   34C    P8    32W / 149W |   1297MiB / 11441MiB |      0%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
</pre></div>
</div>
<p>Note the driver version (which is actually the kernel driver version),
and verify it matches the version you installed on your docker image.</p>
<p>Finally, check that your render window is using NVIDIA by running
<code class="docutils literal notranslate"><span class="pre">ReportCapabilities</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyvista</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pl</span> <span class="o">=</span> <span class="n">pyvista</span><span class="o">.</span><span class="n">Plotter</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">ren_win</span><span class="o">.</span><span class="n">ReportCapabilities</span><span class="p">())</span>

<span class="go">OpenGL vendor string:  NVIDIA Corporation</span>
<span class="go">OpenGL renderer string:  Tesla K80/PCIe/SSE2</span>
<span class="go">OpenGL version string:  4.6.0 NVIDIA 450.51.06</span>
<span class="go">OpenGL extensions:</span>
<span class="go">  GL_AMD_multi_draw_indirect</span>
<span class="go">  GL_AMD_seamless_cubemap_per_texture</span>
<span class="go">  GL_ARB_arrays_of_arrays</span>
<span class="go">  GL_ARB_base_instance</span>
<span class="go">  GL_ARB_bindless_texture</span>
</pre></div>
</div>
<p>If you get <code class="docutils literal notranslate"><span class="pre">display</span> <span class="pre">id</span> <span class="pre">not</span> <span class="pre">set</span></code>, then your environment is likely not
setup correctly.</p>
</div>
</div>


              </div>
              
              
          </main>
          

      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-140243896-1', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2017-2021, The PyVista Developers.<br/>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.0.2.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>